(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21d835"],{d22c:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:e.title,visible:e.visible,width:"80%","before-close":e.close,"close-on-click-modal":!1,inline:!0},on:{"update:visible":function(t){e.visible=t}}},[s("el-form",{ref:"userDatabaseForm",attrs:{model:e.content,size:"small"}},[s("el-form-item",{attrs:{label:"用户",prop:"userIds","label-width":"100px"}},[s("el-select",{attrs:{multiple:"",placeholder:"请选择用户"},model:{value:e.content.userIds,callback:function(t){e.$set(e.content,"userIds",t)},expression:"content.userIds"}},e._l(e.users,(function(e){return s("el-option",{key:e.id,attrs:{value:e.id,label:e.userName}})})),1)],1),s("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"5px"}},[s("el-col",{attrs:{span:3,align:"center"}},[e._v("开始时间")]),s("el-col",{attrs:{span:3,align:"center"}},[e._v("结束时间")]),s("el-col",{attrs:{span:7,align:"center"}},[e._v("分类限制")]),s("el-col",{attrs:{span:5,align:"center"}},[e._v("数据年限")]),s("el-col",{attrs:{span:2,align:"center"}},[e._v("状态")]),s("el-col",{attrs:{span:3,align:"center"}},[e._v("备注")]),s("el-divider"),e._l(e.content.userDatabase,(function(t,a){return s("el-row",{key:a,staticStyle:{"margin-bottom":"5px"}},[s("el-col",{attrs:{span:3}},[s("el-date-picker",{staticStyle:{width:"95%"},attrs:{type:"date",size:"small","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期"},model:{value:t.beginTime,callback:function(s){e.$set(t,"beginTime",s)},expression:"database.beginTime"}})],1),s("el-col",{attrs:{span:3}},[s("el-date-picker",{staticStyle:{width:"95%"},attrs:{type:"date",size:"small","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期"},model:{value:t.endTime,callback:function(s){e.$set(t,"endTime",s)},expression:"database.endTime"}})],1),s("el-col",{attrs:{span:7}},[s("el-select",{staticStyle:{width:"95%"},attrs:{"collapse-tags":!0,clearable:!0,filterable:"",multiple:"",size:"small"},on:{change:function(s){e.changeClassify(t,s)}},model:{value:t.classifyArray,callback:function(s){e.$set(t,"classifyArray",s)},expression:"database.classifyArray"}},e._l(e.statClasses,(function(e){return s("el-option",{key:e.classNumber,attrs:{value:e.classNumber,label:e.name}})})),1)],1),s("el-col",{attrs:{span:5}},[s("el-date-picker",{staticStyle:{width:"45%"},attrs:{type:"year",size:"small","value-format":"yyyy",placeholder:"开始年份"},model:{value:t.inceptionYear,callback:function(s){e.$set(t,"inceptionYear",s)},expression:"database.inceptionYear"}}),e._v(" - "),s("el-date-picker",{staticStyle:{width:"45%"},attrs:{type:"year",size:"small","value-format":"yyyy",placeholder:"结束年份"},model:{value:t.terminationYear,callback:function(s){e.$set(t,"terminationYear",s)},expression:"database.terminationYear"}})],1),s("el-col",{attrs:{span:2}},[s("el-select",{staticStyle:{width:"95%"},attrs:{size:"small"},model:{value:t.effective,callback:function(s){e.$set(t,"effective",s)},expression:"database.effective"}},[s("el-option",{attrs:{value:!0,label:"有效"}}),s("el-option",{attrs:{value:!1,label:"无效"}})],1)],1),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"备注信息",size:"small"},model:{value:t.remark,callback:function(s){e.$set(t,"remark",s)},expression:"database.remark"}})],1)],1)}))],2)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.close}},[e._v("取 消")]),s("el-button",{attrs:{"el-button":"",type:"primary"},on:{click:e.submit}},[e._v("确定")])],1)],1)],1)},l=[],i=(s("4160"),s("a15b"),s("a434"),s("159b"),s("bc3a")),n=s.n(i),r={props:["databaseList"],data:function(){return{visible:!1,title:"",content:{userIds:[],userDatabase:[{beginTime:this.$moment(new Date).format("yyyy-MM-DD HH:mm:ss"),classifyArray:[]}]},statClasses:[],users:[],selectedClassify:[]}},created:function(){this.getStatClasses(),this.getUnsetUsers()},methods:{show:function(){var e=this;this.getUnsetUsers(),this.title="新增包库信息",this.visible=!0,this.statClasses.forEach((function(t){e.content.userDatabase[0].classifyArray.push(t.classNumber)}))},close:function(){this.content={userIds:[],userDatabase:[{beginTime:this.$moment(new Date).format("yyyy-MM-DD HH:mm:ss"),classifyArray:[]}]},this.visible=!1},getStatClasses:function(){var e=this;this.$axiosRequest("/system/statClass/getStatClasses",{},this.$axiosOptions("get")).then((function(t){e.statClasses=t.statClasses}))},changeClassify:function(e,t){var s="";e.classifyArray.forEach((function(e){s+=e+","})),s=s.substring(0,s.length-1),e.classify=s},addUserDatabase:function(){this.content.userDatabase.push({})},removeUserDatabase:function(e){this.content.userDatabase.splice(e,1)},getUnsetUsers:function(){var e=this;this.$axiosRequest("/system/userDatabase/getUnsetUsers",{},this.$axiosOptions("get")).then((function(t){e.users=t.users}))},submit:function(){var e=this,t=!0;this.content.userDatabase.forEach((function(s,a){s.beginTime&&s.endTime||(e.$message.error("包库信息开始/结束时间不能为空!"),t=!1)})),0!==this.content.userIds.length?t&&this.$refs.userDatabaseForm.validate((function(t){if(t){var s=JSON.parse(JSON.stringify(e.content));s.userDatabase.forEach((function(e){e.classify=e.classifyArray.join(",")})),n()({method:"post",url:"system/userDatabase/batchAddUserDatabase",data:s}).then((function(t){t.data.success?(e.$message.success("操作成功!"),e.visible=!1,e.close(),e.$emit("callback")):e.$message.error(t.data.msg)}))}})):this.$message.error("请选择用户！")}}},o=r,c=s("2877"),u=Object(c["a"])(o,a,l,!1,null,null,null);t["default"]=u.exports}}]);