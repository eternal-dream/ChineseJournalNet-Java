(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22c2f1"],{f1c3:function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{id:"searcher"}},[t("div",{staticClass:"layui-form l-width"},["/qikan/index"!=e.$route.path?t("div",{staticClass:"search-label"},[e._v("期刊文献"),t("sup",[e._v("+")])]):e._e(),t("div",{staticClass:"search"},[t("div",{staticClass:"search-sel"},[t("el-select",{attrs:{id:"Select11"},model:{value:e.searchParam.searchModels[0].searchField,callback:function(a){e.$set(e.searchParam.searchModels[0],"searchField",a)},expression:"searchParam.searchModels[0].searchField"}},[t("el-option",{attrs:{value:"U",label:"任意字段"}}),t("el-option",{attrs:{value:"M",label:"题名或关键词"}}),t("el-option",{attrs:{value:"T",label:"题名"}}),t("el-option",{attrs:{value:"K",label:"关键词"}}),t("el-option",{attrs:{value:"R",label:"文摘"}}),t("el-option",{attrs:{value:"A",label:"作者"}}),t("el-option",{attrs:{value:"F",label:"第一作者"}}),t("el-option",{attrs:{value:"S",label:"机构"}}),t("el-option",{attrs:{value:"J",label:"刊名"}}),t("el-option",{attrs:{value:"C",label:"分类号"}}),t("el-option",{attrs:{value:"I",label:"基金资助"}}),t("el-option",{attrs:{value:"L",label:"栏目信息"}})],1)],1),t("div",{staticClass:"search-input"},[t("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.autoComplete,"trigger-on-focus":!1},on:{blur:function(a){e.inputTime=(new Date).getTime()},select:function(a){return e.handleSeachClick()}},model:{value:e.searchParam.searchModels[0].value,callback:function(a){e.$set(e.searchParam.searchModels[0],"value",a)},expression:"searchParam.searchModels[0].value"}})],1),t("div",{staticClass:"search-btn"},[t("button",{staticClass:"layui-btn",on:{click:function(a){return e.handleSeachClick()}}},[e._v("检索")])]),t("ul",{staticClass:"search-tool"},[t("li",[t("router-link",{attrs:{to:"/search/advance",target:"_blank"}},[e._v("高级检索")])],1),t("li",["/qikan/index"!=e.$route.path?t("a",{attrs:{href:"javasrcipt:void(0)"},on:{click:e.jumpJournalIndex}},[e._v("期刊导航")]):e._e()])])])])])},r=[],i=(t("4160"),t("d3b7"),t("ac1f"),t("5319"),t("841c"),t("159b"),t("bc3a")),l=t.n(i),c={name:"Searcher",data:function(){return{searchParam:{pageNum:1,pageSize:20,sortField:"",fq:"",searchExpression:"",searchByExpression:!1,searchModels:[{searchField:"U",value:"",exact:!1,logicOperator:"AND",displayValue:""}],inputTime:0}}},methods:{search:function(e){var a=this,t=this.searchParam;if(e){var s=this.searchParam.searchModels[0];t=e,t.searchModels.unshift(s)}this.$emit("loadingFacet");var r=this.$loading({lock:!0,text:"加载中...",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.5)"});l()({method:"post",url:"view/search/search",data:t}).then((function(e){e.data.success?(a.$emit("completeSearch",e),r.close()):a.$message.error(e.data.msg)})).catch((function(e){r.close()})),l()({method:"post",url:"view/search/getFacet",data:t}).then((function(e){e.data.success?("J"===t.searchModels[0].searchField&&t.searchModels[0].value&&e.data.facet.mediaFacet&&e.data.facet.mediaFacet.length>0&&(e.data.facet.mediaFacet[0].keyword=t.searchModels[0].value,a.$emit("showMedias",e.data.facet.mediaFacet)),a.$emit("completeGetFacet",e)):a.$message.error(e.data.msg)}))},handleSeachClick:function(){"/search/index"!==this.$route.path?this.$router.push({path:"/search/index",query:{searchModels:JSON.stringify(this.searchParam.searchModels)}}):this.search()},autoComplete:function(e,a){var t=this;this.inputTime=(new Date).getTime(),setTimeout((function(){var e=(new Date).getTime();e-t.inputTime>=680&&t.searchParam.searchModels[0].value?t.$axiosRequest("view/search/autoComplete",{value:t.searchParam.searchModels[0].value},t.$axiosOptions("get")).then((function(e){var t=[];e.suggests.forEach((function(e){t.push({value:e})})),a(t)})):a([])}),700)},getSubFacet:function(e,a,t){var s=this.searchParam;if(e){var r=this.searchParam.searchModels[0];s=e,s.searchModels.unshift(r)}return s.fq=a,new Promise((function(e){l()({method:"post",url:t,data:s}).then((function(a){e(a)}))}))},handleKeyDown:function(e){var a=null;a=void 0===window.event?e.keyCode:window.event.keyCode,13===a&&this.handleSeachClick()},jumpJournalIndex:function(){"/journal/index"===this.$route.path?this.$router.replace("/refresh"):this.$router.push({path:"/journal/index"})}},mounted:function(){this.$route.query&&this.$route.query.searchModels?this.searchParam.searchModels=JSON.parse(this.$route.query.searchModels):this.searchParam.searchModels=[{searchField:"U",value:"",exact:!1,logicOperator:"AND",displayValue:""}],"/search/index"===this.$route.path&&this.search()},created:function(){window.addEventListener("keydown",this.handleKeyDown,!0)},destroyed:function(){window.removeEventListener("keydown",this.handleKeyDown,!0)}},o=c,n=t("2877"),h=Object(n["a"])(o,s,r,!1,null,null,null);a["default"]=h.exports}}]);