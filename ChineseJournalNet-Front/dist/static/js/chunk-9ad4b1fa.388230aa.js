(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9ad4b1fa"],{"0412":function(t,e,r){"use strict";r.r(e);r("4160"),r("c975"),r("ac1f"),r("466d"),r("5319"),r("1276"),r("159b");var n=r("22ce"),l=r("39f3"),i=r("21a6"),a=r("1146"),g=r.n(a);e["default"]={name:"ExportIndex",data:function(){return{ids:[],articleList:[],showType:["文  本","查新格式","参考文献","XML","NoteExpress","Refworks","EndNote","Note First","自定义导出","Excel导出"],checkBoxes:["题名","作者","刊名","机构","文摘","ISSN","CN","页码","关键词","分类号","网址"],typeIndex:0,checked:["题名","作者","刊名","机构","文摘","ISSN","CN","页码","关键词","分类号","网址"]}},methods:{getIdsFromRouter:function(){this.ids=this.$route.query.ids,this.ids.length>0?this.getArticleList():(alert("没有选择需要导出的数据！"),this.$router.go(-1))},formatArticle:function(t){var e=[];return t.forEach((function(t){e.push(t.ndo_content)})),e},getArticleList:function(){var t=this,e=this.ids;Object(n["axiosRequest"])(l["a"]+"search/getArticlesByIds",e,Object(n["axiosOptions"])(null,n["commonContentType"].json)).then((function(e){e.success&&(t.articleList=t.formatArticle(e.pageBean.rows))}))},changeSHowType:function(t){this.typeIndex=t,9==t&&this.exportExcel()},cancelChoose:function(){this.checked=[]},customExport:function(){var t=this.checked;if(t.length<=0)this.$message.error("请选择需要导出的数据！");else{var e=this.buildCuscom(),r=new Blob([e],{type:"text/plain;charset=utf-8"}),n=this.$moment(new Date).format("YYYY-MM-DD")+"@cuscom.txt";Object(i["saveAs"])(r,n)}},buildTxt:function(){for(var t="",e=this.articleList,r=0;r<e.length;r++)t+="["+(r+1)+"] "+(e[r].showwriter?e[r].showwriter.replace(/\[.*?\]/g,"").replace(";",",")+".":"")+e[r].title_c+(e[r].media_c?"."+e[r].media_c+"[J]":"")+","+e[r].years+"("+e[r].num+"):"+(e[r].beginpage?e[r].beginpage+"-":"")+e[r].endpage+(e[r].remark_c?"\r\n"+e[r].remark_c:"")+"\r\n\r\n";return t.replace(/undefined/g,"")},buildChaxin:function(){for(var t="",e=this.articleList,r=0;r<e.length;r++)t+="["+(r+1)+"]"+(e[r].showwriter?e[r].showwriter.replace(/\[.*?\]/g,"").replace(";",",")+".":"")+e[r].title_c+(e[r].media_c?"."+e[r].media_c+"[J]":"")+","+e[r].years+"("+e[r].num+"):"+(e[r].beginpage?e[r].beginpage+"-":"")+e[r].endpage+".\r\n机构：",e[r].showorgan?t+=e[r].showorgan.replace(/\[.*?\]/g,""):t+="",t+="\r\n摘要："+e[r].remark_c+"\r\n\r\n";return t.replace(/undefined/g,"")},buildRef:function(){for(var t="",e=this.articleList,r=0;r<e.length;r++)t+="["+(r+1)+"] "+(e[r].showwriter?e[r].showwriter.replace(/\[.*?\]/g,"").replace(";",",")+".":"")+e[r].title_c+"[J]"+e[r].media_c+","+e[r].years+",("+e[r].num+"):"+e[r].beginpage+"-"+e[r].endpage+"\r\n \r\n";return t.replace(/undefined/g,"")},buildXml:function(){for(var t='&lt;?xml version="1.0" encoding="utf-8"?&gt;\r\n &lt;ResourceList&gt;',e=this.articleList,r=0;r<e.length;r++){t+='\r\n\r\n&lt;PeriodicalPaper xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;\r\n    &lt;Type&gt;'+(r+1)+"&lt;/Type&gt;\r\n    &lt;ID&gt;"+e[r].lngid+"&lt;/ID&gt;\r\n    &lt;Titles&gt;\r\n    &lt;Title&gt;\r\n    &lt;Language&gt;chi&lt;/Language&gt;\r\n    &lt;Text&gt;&lt;![CDATA["+e[r].title_c+"]]&gt;&lt;/Text&gt;\r\n    &lt;/Title&gt;\r\n    &lt;/Titles&gt;\r\n    &lt;Creators&gt;\r\n";var n=e[r].showwriter;if(n)if(-1!=n.indexOf(";")){var l=n.split(";");l.forEach((function(e){t+="    &lt;Creator&gt;\r\n    &lt;Name&gt;&lt;![CDATA["+e+"]]&gt;&lt;/Name&gt;\r\n    &lt;/Creator&gt;\r\n"}))}else t+="    &lt;Creator&gt;\r\n    &lt;Name&gt;&lt;![CDATA["+n+"]]&gt;&lt;/Name&gt;\r\n    &lt;/Creator&gt;\r\n";else t+="    &lt;Creator&gt;\r\n    &lt;Name&gt;&lt;![CDATA[]]&gt;&lt;/Name&gt;\r\n    &lt;/Creator&gt;\r\n";if(t+="    &lt;/Creators&gt;\r\n    &lt;PublishDate&gt;&lt;![CDATA["+e[r].publishdate+"]]&gt;&lt;/PublishDate&gt;\r\n    &lt;CLCs&gt;\r\n",e[r].class)if(-1!=e[r].class.indexOf(";")){var i=e[r].class.split(";");i.forEach((function(e){t+="    &lt;CLC&gt;\r\n    &lt;Code&gt;&lt;![CDATA["+e+"]]&gt;&lt;/Code&gt;\r\n    &lt;/CLC&gt;\r\n"}))}else t+="    &lt;CLC&gt;\r\n    &lt;Code&gt;&lt;![CDATA["+e[r].class+"]]&gt;&lt;/Code&gt;\r\n    &lt;/CLC&gt;\r\n";t+="    &lt;/CLCs&gt;\r\n    &lt;HasOriginalDoc&gt;true&lt;/HasOriginalDoc&gt;\r\n    &lt;DataSource&gt;&lt;/DataSource&gt;\r\n    &lt;Keywords&gt;\r\n";var a=e[r].keyword_c;if(a)if(-1!=a.indexOf(";")){var g=a.split(";");g.forEach((function(e){t+="    &lt;Keyword&gt;&lt;![CDATA["+e.replace(/\[.*?\]/g,"")+"]]&gt;&lt;/Keyword&gt;\r\n"}))}else t+="    &lt;Keyword&gt;&lt;![CDATA["+a.replace(/\[.*?\]/g,"")+"]]&gt;&lt;/Keyword&gt;\r\n";else t+="    &lt;Keyword&gt;&lt;![CDATA[]]&gt;&lt;/Keyword&gt;\r\n";t+="    &lt;/Keywords&gt;\r\n    &lt;Abstracts&gt;\r\n    &lt;Abstract&gt;\r\n    &lt;Text&gt;&lt;![CDATA["+e[r].remark_c+"]]&gt;&lt;/Text&gt;\r\n    &lt;/Abstract&gt;\r\n    &lt;/Abstracts&gt;\r\n    &lt;Periodical&gt;\r\n    &lt;ID&gt;"+e[r].gch+"&lt;/ID&gt;\r\n    &lt;Name&gt;&lt;![CDATA["+e[r].media_c+"]]&gt;&lt;/Name&gt;\r\n    &lt;ISSN&gt;"+e[r].issn+"&lt;/ISSN&gt;\r\n    &lt;/Periodical&gt;\r\n    &lt;Column&gt;&lt;/Column&gt;\r\n",e[r].vol&&(t+="    &lt;Volum&gt;&lt;![CDATA["+e[r].vol+"]]&gt;&lt;/Volum&gt;\r\n"),t+="    &lt;Issue&gt;&lt;![CDATA["+e[r].num+"]]&gt;&lt;/Issue&gt;\r\n    &lt;Page&gt;"+e[r].beginpage+"-"+e[r].endpage+"&lt;/Page&gt;\r\n    &lt;Organs&gt;\r\n";var s=e[r].showorgan;if(s)if(-1!=s.indexOf(";")){var o=s.split(";");o.forEach((function(e){t+="    &lt;Organ&gt;&lt;![CDATA["+e.replace(/\[.*?\]/g,"")+"]]&gt;&lt;/Organ&gt;\r\n"}))}else t+="    &lt;Organ&gt;&lt;![CDATA["+s.replace(/\[.*?\]/g,"")+"]]&gt;&lt;/Organ&gt;\r\n";else t+="    &lt;Organ&gt;&lt;![CDATA[]]&gt;&lt;/Organ&gt;\r\n";t+="    &lt;/Organs&gt;\r\n    &lt;ServiceMode&gt;1&lt;/ServiceMode&gt;\r\n    &lt;/PeriodicalPaper&gt;"}return t+="\r\n    &lt;/ResourceList&gt;",t.replace(/undefined/g,"").replace(/&gt;/g,">").replace(/&lt;/g,"<")},buildNote:function(){for(var t="",e=this.articleList,r=0;r<e.length;r++){t+="{Reference Type}: Journal Article \r\n",t+="{Title}:"+e[r].title_c+"\r\n";var n=e[r].showwriter;if(n)if(-1!=n.indexOf(";")){var l=n.split(";");l.forEach((function(e){t+="{Author}: "+e.replace(/\[.*?\]/g,"")+"\r\n"}))}else t+="{Author}: "+n.replace(/\[.*?\]/g,"")+"\r\n";t+="{Journal}: "+e[r].media_c+"\r\n{Year}: "+e[r].years,e[r].vol&&(t+="\r\n{Volume} : "+e[r].vol),t+="\r\n{Issue}: "+e[r].num+"\r\n";var i=e[r].keyword_c;if(i)if(-1!=i.indexOf(";")){var a=i.split(";");a.forEach((function(e){t+="{Keywords}:"+e.replace(/\[.*?\]/g,"")+"\r\n"}))}else t+="{Keywords}:"+i.replace(/\[.*?\]/g,"")+"\r\n";t+="{Abstract}: "+e[r].remark_c+"\r\n{URL}: "+window.location.href.match(/^(?:[^\/]|\/\/)*/)+"/detail/index?lngid="+e[r].lngid+"\r\n{Database Provider}: 重庆维普资讯有限公司\r\n \r\n \r\n \r\n"}return t.replace(/undefined/g,"")},buildRefworks:function(){for(var t="",e=this.articleList,r=0;r<e.length;r++)t+="RT Journal \r\n",t+="T1 "+e[r].title_c+"\r\nJF "+e[r].media_c+"\r\nYR "+e[r].years+"\r\nVO "+e[r].vol+"\r\nIS "+e[r].num+"\r\nAB "+e[r].remark_c+"\r\nLK "+window.location.href.match(/^(?:[^\/]|\/\/)*/)+"/detail/index?lngid="+e[r].lngid+"\r\nA1 "+(e[r].showwriter?e[r].showwriter.replace(/\[.*?\]/g,""):"")+"\r\nAD "+(e[r].showorgan?e[r].showorgan.replace(/\[.*?\]/g,""):"")+"\r\nCL "+e[r].class+"\r\nK1 "+(e[r].keyword_c?e[r].keyword_c.replace(/\[.*?\]/g,""):"")+"\r\nPP 中国 \r\nDS 重庆维普 \r\nNO 作者个数:"+(e[r].showwriter?e[r].showwriter.split(";").length:0)+"; 第一作者:"+e[r].firstwriter+"\r\n\r\n";return t.replace(/undefined/g,"")},buildEndNote:function(){for(var t="",e=this.articleList,r=0;r<e.length;r++)t+="%0 Journal Article \r\n",t+="%A "+e[r].showwriter+"\r\n%+:"+(e[r].showorgan?e[r].showorgan.replace(/\[.*?\]/g,""):"")+"\r\n%T "+e[r].title_c+"\r\n%J "+e[r].media_c+"\r\n%D "+e[r].years+"\r\n%N "+e[r].num+"\r\n%V "+e[r].vol+"\r\n%K "+(e[r].keyword_c?e[r].keyword_c.replace(/\[.*?\]/g,""):"")+"\r\n%X "+e[r].remark_c+"\r\n%U "+window.location.href.match(/^(?:[^\/]|\/\/)*/)+"/detail/index?lngid="+e[r].lngid+"\r\n%W 重庆维普资讯有限公司 \r\n\r\n";return t.replace(/undefined/g,"")},buildNoteFirst:function(){for(var t=this.articleList,e='&lt;?xml version="1.0" encoding="utf-8"?&gt;\r\n &lt;Bibliographies&gt;\r\n&lt;BibliographiesCount&gt;'+t.length+"&lt;/BibliographiesCount&gt;\r\n",r=0;r<t.length;r++){var n=t[r];e+='&lt;Bibliography&gt;\r\n&lt;Type&gt;JournalArticle&lt;/Type&gt;\r\n&lt;Language&gt;zh-CHS&lt;/Language&gt;\r\n&lt;PrimaryTitle&gt; &lt;Title Lang="zh-CHS"&gt;&lt;![CDATA['+n.title_c+']]&gt;&lt;/Title&gt;&lt;/PrimaryTitle&gt;\r\n&lt;Authors&gt;&lt;Author&gt;&lt;Info lang="zh-CHS"&gt;\r\n&lt;FullName&gt;&lt;![CDATA['+(n.showwriter?n.showwriter.replace(/\[.*?\]/g,""):"")+"]]&gt;&lt;/FullName&gt;\r\n&lt;Organization&gt;&lt;![CDATA[[1]"+(n.showorgan?n.showorgan.replace(/\[.*?\]/g,""):"")+']]&gt;&lt;/Organization&gt;\r\n&lt;/Info&gt;&lt;/Author&gt;&lt;/Authors&gt;\r\n&lt;Medium&gt;&lt;Media Lang="zh-CHS"&gt;&lt;![CDATA['+n.media_c+"]]&gt;&lt;/Media&gt;&lt;/Medium&gt;\r\n&lt;Year&gt;&lt;![CDATA["+n.years+"]]&gt;&lt;/Year&gt;\r\n&lt;Volume&gt;&lt;![CDATA["+n.volumn+"]]&gt;&lt;/Volume&gt;\r\n&lt;Issue&gt;&lt;![CDATA["+n.num+']]&gt;&lt;/Issue&gt;\r\n&lt;Keywords&gt;\r\n&lt;Keyword Lang="zh-CHS"&gt;&lt;![CDATA['+n.keyword_c+']]&gt;&lt;/Keyword&gt;\r\n&lt;Keyword Lang="en"&gt;&lt;![CDATA['+n.keyword_e+']]&gt;&lt;/Keyword&gt;\r\n&lt;/Keywords&gt;\r\n&lt;Abstracts&gt;&lt;Abstract Lang="zh-CHS"&gt;\r\n&lt;![CDATA['+n.remark_c+"]]&gt;\r\n&lt;/Abstract&gt; &lt;/Abstracts&gt;\r\n&lt;PageScope&gt;&lt;![CDATA["+n.beginpage+"-"+n.endpage+"]]&gt;&lt;/PageScope&gt;\r\n&lt;Publisher&gt;&lt;![CDATA["+n.publisher+"]]&gt;&lt;/Publisher&gt;\r\n&lt;Code&gt;&lt;![CDATA["+n.class+"]]&gt;&lt;/Code&gt;\r\n&lt;/Bibliography&gt;\r\n\r\n"}return e+="&lt;/Bibliographies&gt;",e.replace(/undefined/g,"").replace(/&gt;/g,">").replace(/&lt;/g,"<")},buildCuscom:function(){for(var t=this.checked,e="〖检索时间〗"+this.$moment(new Date).format("YYYY-MM-DD HH:mm:ss")+"\r\n 〖检索结果〗选中"+this.ids.length+"篇\r\n",r=this.articleList,n=0;n<r.length;n++)e+="【序  号】"+(n+1)+"/"+r.length+"\r\n",-1!=t.indexOf("题名")&&(e+="【题　名】"+r[n].title_c+"\r\n"),-1!=t.indexOf("作者")&&(e+="【作　者】"+(r[n].showwriter?r[n].showwriter.replace(/\[.*?\]/g,""):"")+"\r\n"),-1!=t.indexOf("机构")&&(e+="【机　构】"+(r[n].showorgan?r[n].showorgan.replace(/\[.*?\]/g,""):"")+"\r\n"),-1!=t.indexOf("刊名")&&(e+="【刊　名】"+r[n].media_c+r[n].years+" "+r[n].vol+"("+r[n].num+"):"+r[n].beginpage+"-"+r[n].endpage+"\r\n"),-1!=t.indexOf("ISSN")&&(e+="【ISSN号】"+r[n].issn+"\r\n"),-1!=t.indexOf("CN")&&(e+="【C N 号】"+r[n].cn+"\r\n"),-1!=t.indexOf("页码")&&(e+="【页　码】"+r[n].beginpage+"-"+r[n].endpage+"\r\n"),-1!=t.indexOf("关键词")&&(e+="【关键词】"+r[n].keyword_c+"\r\n"),-1!=t.indexOf("分类号")&&(e+="【分类号】"+r[n].class+"\r\n"),-1!=t.indexOf("文摘")&&(e+="【文　摘】"+r[n].remark_c+"\r\n"),-1!=t.indexOf("网址")&&(e+="【网　址】"+window.location.href.match(/^(?:[^\/]|\/\/)*/)+"/detail/index?lngid="+r[n].lngid+"\r\n"),e+="\r\n\r\n";return e.replace(/undefined/g,"")},exportExcel:function(){var t=g.a.utils.table_to_book(document.getElementById("outTable")),e=g.a.write(t,{bookType:"xlsx",bookSST:!0,type:"array"}),r=this.$moment(new Date).format("YYYY-MM-DD")+"cqvip.xlsx";Object(i["saveAs"])(new Blob([e],{type:"application/octet-stream"}),r)},exportFile:function(){var t,e=this.typeIndex,r=this.$moment(new Date).format("YYYY-MM-DD");switch(e){case 0:t=this.buildTxt(),r+="@txt.txt";break;case 1:t=this.buildChaxin(),r+="@cx.txt";break;case 2:t=this.buildRef(),r+="@ref.txt";break;case 3:t=this.buildXml(),r+="@xml.xml";break;case 4:t=this.buildNote(),r+="@note.txt";break;case 5:t=this.buildRefworks(),r+="@rew.txt";break;case 6:t=this.buildEndNote(),r+="@end.txt";break;case 7:t=this.buildNoteFirst(),r+="@nf.txt";break;case 8:t=this.buildCuscom(),r+="@cus.txt";default:break}var n=new Blob([t],{type:"text/plain;charset=utf-8"});Object(i["saveAs"])(n,r)},printFile:function(){window.print()},windowPath:function(t){return window.location.href.match(/^(?:[^\/]|\/\/)*/)+"/detail/index?lngid="+t.lngid.replace(/\<.*?\>/g,"")},doCopy:function(){var t,e=this,r=this.typeIndex;switch(r){case 0:t=this.buildTxt();break;case 1:t=this.buildChaxin();break;case 2:t=this.buildRef();break;case 3:t=this.buildXml();break;case 4:t=this.buildNote();break;case 5:t=this.buildRefworks();break;case 6:t=this.buildEndNote();break;case 7:t=this.buildNoteFirst();break;default:break}this.$copyText(t).then((function(t){e.$message.success("内容已成功复制到剪贴板！")})).catch((function(t){e.$message.error("复制内容出错！")}))}},created:function(){this.getIdsFromRouter()}}},1276:function(t,e,r){"use strict";var n=r("d784"),l=r("44e7"),i=r("825a"),a=r("1d80"),g=r("4840"),s=r("8aa5"),o=r("50c4"),c=r("14c3"),d=r("9263"),u=r("d039"),h=[].push,f=Math.min,p=4294967295,w=!u((function(){return!RegExp(p,"y")}));n("split",2,(function(t,e,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,r){var n=String(a(this)),i=void 0===r?p:r>>>0;if(0===i)return[];if(void 0===t)return[n];if(!l(t))return e.call(n,t,i);var g,s,o,c=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,w=new RegExp(t.source,u+"g");while(g=d.call(w,n)){if(s=w.lastIndex,s>f&&(c.push(n.slice(f,g.index)),g.length>1&&g.index<n.length&&h.apply(c,g.slice(1)),o=g[0].length,f=s,c.length>=i))break;w.lastIndex===g.index&&w.lastIndex++}return f===n.length?!o&&w.test("")||c.push(""):c.push(n.slice(f)),c.length>i?c.slice(0,i):c}:"0".split(void 0,0).length?function(t,r){return void 0===t&&0===r?[]:e.call(this,t,r)}:e,[function(e,r){var l=a(this),i=void 0==e?void 0:e[t];return void 0!==i?i.call(e,l,r):n.call(String(l),e,r)},function(t,l){var a=r(n,t,this,l,n!==e);if(a.done)return a.value;var d=i(t),u=String(this),h=g(d,RegExp),m=d.unicode,b=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(w?"y":"g"),A=new h(w?d:"^(?:"+d.source+")",b),x=void 0===l?p:l>>>0;if(0===x)return[];if(0===u.length)return null===c(A,u)?[u]:[];var C=0,v=0,y=[];while(v<u.length){A.lastIndex=w?v:0;var T,D=c(A,w?u:u.slice(v));if(null===D||(T=f(o(A.lastIndex+(w?0:v)),u.length))===C)v=s(u,v,m);else{if(y.push(u.slice(C,v)),y.length===x)return y;for(var k=1;k<=D.length-1;k++)if(y.push(D[k]),y.length===x)return y;v=C=T}}return y.push(u.slice(C)),y}]}),!w)},3:function(t,e){},4:function(t,e){},5:function(t,e){}}]);