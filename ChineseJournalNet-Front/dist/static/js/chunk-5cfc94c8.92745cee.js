(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5cfc94c8"],{1276:function(t,e,r){"use strict";var l=r("d784"),n=r("44e7"),a=r("825a"),i=r("1d80"),s=r("4840"),o=r("8aa5"),c=r("50c4"),g=r("14c3"),u=r("9263"),_=r("d039"),d=[].push,b=Math.min,h=4294967295,p=!_((function(){return!RegExp(h,"y")}));l("split",2,(function(t,e,r){var l;return l="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,r){var l=String(i(this)),a=void 0===r?h:r>>>0;if(0===a)return[];if(void 0===t)return[l];if(!n(t))return e.call(l,t,a);var s,o,c,g=[],_=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),b=0,p=new RegExp(t.source,_+"g");while(s=u.call(p,l)){if(o=p.lastIndex,o>b&&(g.push(l.slice(b,s.index)),s.length>1&&s.index<l.length&&d.apply(g,s.slice(1)),c=s[0].length,b=o,g.length>=a))break;p.lastIndex===s.index&&p.lastIndex++}return b===l.length?!c&&p.test("")||g.push(""):g.push(l.slice(b)),g.length>a?g.slice(0,a):g}:"0".split(void 0,0).length?function(t,r){return void 0===t&&0===r?[]:e.call(this,t,r)}:e,[function(e,r){var n=i(this),a=void 0==e?void 0:e[t];return void 0!==a?a.call(e,n,r):l.call(String(n),e,r)},function(t,n){var i=r(l,t,this,n,l!==e);if(i.done)return i.value;var u=a(t),_=String(this),d=s(u,RegExp),v=u.unicode,w=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(p?"y":"g"),f=new d(p?u:"^(?:"+u.source+")",w),m=void 0===n?h:n>>>0;if(0===m)return[];if(0===_.length)return null===g(f,_)?[_]:[];var y=0,C=0,A=[];while(C<_.length){f.lastIndex=p?C:0;var x,T=g(f,p?_:_.slice(C));if(null===T||(x=b(c(f.lastIndex+(p?0:C)),_.length))===y)C=o(_,C,v);else{if(A.push(_.slice(y,C)),A.length===m)return A;for(var k=1;k<=T.length-1;k++)if(A.push(T[k]),A.length===m)return A;C=y=x}}return A.push(_.slice(y)),A}]}),!p)},"16b1":function(t,e,r){"use strict";r.r(e);var l=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("vip-header"),r("div",{attrs:{id:"body"}},[r("div",{staticClass:"l-width"},[t._m(0),r("div",{staticClass:"row export"},[r("div",{staticClass:"layui-tab"},[r("div",{staticClass:"export-type"},[r("div",{staticClass:"label"},[t._v("文献导出格式")]),r("ul",{staticClass:"layui-tab-title"},t._l(t.showType,(function(e,l){return r("li",{class:{"layui-this":t.typeIndex==l},on:{click:function(e){return t.changeSHowType(l)}}},[t._v(t._s(e)+" ")])})),0)]),8!==t.typeIndex?r("div",{staticClass:"export-op"},[r("a",{staticClass:"layui-btn layui-btn-primary",on:{click:function(e){return t.doCopy()}}},[r("i",{staticClass:"icon-copy"}),t._v("复制 ")]),r("a",{staticClass:"layui-btn layui-btn-primary",on:{click:function(e){return t.exportFile()}}},[r("i",{staticClass:"icon-export"}),t._v("导出 ")])]):t._e(),r("div",{staticClass:"layui-tab-content export-content"},[r("div",{staticClass:"layui-tab-item",class:{"layui-show":0==t.typeIndex||9==t.typeIndex}},t._l(t.articleList,(function(e,l){return r("p",{key:l},[t._v(" ["+t._s(l+1)+"] "),r("font",{staticStyle:{color:"#008000"}},[t._v(t._s(e.showwriter?e.showwriter.replace(/\[.*?\]/g,"").replace(";",",")+".":""))]),r("font",{staticStyle:{color:"#034481"}},[t._v(t._s(e.title_c)+".")]),r("font",{staticStyle:{color:"#008000"}},[t._v(t._s(e.media_c)+", "+t._s(e.years)+"("+t._s(e.num)+"):"+t._s(e.beginpage)+"-"+t._s(e.endpage)+".")]),r("br"),t._v(" "+t._s(e.remark_c)),r("br")],1)})),0),r("div",{staticClass:"layui-tab-item",class:{"layui-show":1==t.typeIndex}},t._l(t.articleList,(function(e,l){return r("p",{key:l},[t._v(" ["+t._s(l+1)+"] "),r("font",{staticStyle:{color:"#008000"}},[t._v(t._s(e.showwriter?e.showwriter.replace(/\[.*?\]/g,"").replace(";",",")+".":""))]),r("font",{staticStyle:{color:"#034481"}},[t._v(t._s(e.title_c)+".")]),r("font",{staticStyle:{color:"#008000"}},[t._v(t._s(e.media_c)+", "+t._s(e.years)+"("+t._s(e.num)+"):"+t._s(e.beginpage)+"-"+t._s(e.endpage)+".")]),r("br"),t._v(" 机构: "+t._s(e.showorgan?e.showorgan.replace(/\[.*?\]/g,""):"")),r("br"),t._v(" 摘要: "+t._s(e.remark_c)),r("br")],1)})),0),r("div",{staticClass:"layui-tab-item",class:{"layui-show":2==t.typeIndex}},t._l(t.articleList,(function(e,l){return r("p",{key:l},[t._v(" ["+t._s(l+1)+"]"+t._s(e.showwriter?e.showwriter.replace(/\[.*?\]/g,"").replace(";",",")+".":"")+" "+t._s(e.title_c+"[J]")+"."+t._s(e.media_c)+","+t._s(e.years)+"("+t._s(e.num)+"):"+t._s(e.beginpage)+"-"+t._s(e.endpage)+"."),r("br")])})),0),r("div",{staticClass:"layui-tab-item",class:{"layui-show":3==t.typeIndex}},[t._v(' <?xml version="1.0" encoding="utf-8"?> '),r("br"),t._v("<ResourceList> "),t._l(t.articleList,(function(e,l){return[r("br"),r("br"),t._v(' <PeriodicalPaper xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> '),r("br"),t._v(" <Type>1</Type> "),r("br"),t._v(" <ID>"+t._s(e.lngid)+"</ID> "),r("br"),t._v(" <Titles> "),r("br"),t._v(" <Title> "),r("br"),t._v(" <Language>chi</Language> "),r("br"),t._v(" <Text><![CDATA["+t._s(e.title_c)+"]]></Text> "),r("br"),t._v(" </Title> "),r("br"),t._v(" </Titles> "),r("br"),t._v(" <Creators> "),e.showwriter?[t._l(e.showwriter.split(";"),(function(e,l){return[r("br"),t._v(" <Creator> "),r("br"),t._v(" <Name><![CDATA["+t._s(e)+",]]></Name> "),r("br"),t._v(" </Creator> ")]}))]:t._e(),r("br"),t._v(" </Creators> "),r("br"),t._v(" <PublishDate><![CDATA["+t._s(e.publishdate)+"]]></PublishDate> "),r("br"),t._v(" <CLCs> "),e.class?[t._l(e.class.split(";"),(function(e,l){return[r("br"),t._v(" <CLC> "),r("br"),t._v(" <Code><![CDATA["+t._s(e)+"]]></Code> "),r("br"),t._v(" </CLC> ")]}))]:t._e(),r("br"),t._v(" </CLCs> "),r("br"),t._v(" <HasOriginalDoc>true</HasOriginalDoc> "),r("br"),t._v(" <DataSource></DataSource> "),r("br"),t._v(" <Keywords> "),e.keyword_c?[t._l(e.keyword_c.split(";"),(function(e,l){return[r("br"),t._v(" <Keyword><![CDATA[["+t._s(e.replace(/\[.*?\]/g,""))+"]]></Keyword> ")]}))]:t._e(),r("br"),t._v(" </Keywords> "),r("br"),t._v(" <Abstracts> "),r("br"),t._v(" <Abstract> "),r("br"),t._v(" <Text><![CDATA["+t._s(e.remark_c)+"]]></Text> "),r("br"),t._v(" </Abstract> "),r("br"),t._v(" </Abstracts> "),r("br"),t._v(" <Periodical> "),r("br"),t._v(" <ID>94688A</ID> "),r("br"),t._v(" <Name><![CDATA["+t._s(e.media_c)+"]]></Name> "),r("br"),t._v(" <ISSN>"+t._s(e.issn)+"</ISSN> "),r("br"),t._v(" </Periodical> "),r("br"),t._v(" <Column></Column> "),e.vol?[r("br"),t._v(" <Volume><![CDATA["+t._s(e.vol)+"]]></Volum> ")]:t._e(),r("br"),t._v(" <Issue><![CDATA["+t._s(e.num)+"]]></Issue> "),r("br"),t._v(" <Page>"+t._s(e.beginpage)+"-"+t._s(e.endpage)+"</Page> "),r("br"),t._v(" <ServiceMode>1</ServiceMode> "),r("br"),t._v(" <Organs> "),e.showorgan?[t._l(e.showorgan.split(";"),(function(e,l){return[r("br"),t._v(" <Organ><![CDATA["+t._s(e.replace(/\[.*?\]/g,""))+"]]></Organ> ")]}))]:t._e(),r("br"),t._v(" </Organs> "),r("br"),t._v(" </PeriodicalPaper> ")]})),r("br"),t._v("</ResourceList> ")],2),r("div",{staticClass:"layui-tab-item",class:{"layui-show":4==t.typeIndex}},t._l(t.articleList,(function(e,l){return r("p",{key:l},[t._v(" {Reference Type}: Journal Article"),r("br"),t._v(" {Title}: "+t._s(e.title_c)),r("br"),e.showwriter?[t._l(e.showwriter.split(";"),(function(e,l){return[t._v(" {Author}: "+t._s(e.replace(/\[.*?\]/g,""))),r("br")]}))]:t._e(),e.showorgan?[t._l(e.showorgan.split(";"),(function(e,l){return[t._v(" {Author Address}: "+t._s(e.replace(/\[.*?\]/g,""))),r("br")]}))]:t._e(),t._v(" {Journal}: "+t._s(e.media_c)),r("br"),t._v(" {Year}: "+t._s(e.years)),r("br"),e.vol?[t._v(" {Volume}: "+t._s(e.vol)),r("br")]:t._e(),t._v(" {Issue}: "+t._s(e.num)),r("br"),e.keyword_c?[t._l(e.keyword_c.split(";"),(function(e,l){return[t._v(" {Keywords}: "+t._s(e.replace(/\[.*?\]/g,""))),r("br")]}))]:t._e(),t._v(" {Abstract}: "+t._s(e.remark_c)),r("br"),t._v(" {URL}: "+t._s(t.windowPath(e))),r("br"),t._v(" {Database Provider}: 重庆维普资讯有限公司"),r("br")],2)})),0),r("div",{staticClass:"layui-tab-item",class:{"layui-show":5==t.typeIndex}},t._l(t.articleList,(function(e,l){return r("p",{key:l},[t._v(" RT Journal"),r("br"),t._v(" T1 "+t._s(e.title_c)),r("br"),t._v(" JF "+t._s(e.media_c)),r("br"),t._v(" YR "+t._s(e.years)),r("br"),t._v(" VO "+t._s(e.vol)),r("br"),t._v(" IS "+t._s(e.num)),r("br"),t._v(" AB "+t._s(e.remark_c)),r("br"),t._v(" LK "+t._s(t.windowPath(e))),r("br"),t._v(" A1 "+t._s(e.showwriter?e.showwriter.replace(/\[.*?\]/g,""):"")),r("br"),e.showorgan?[t._l(e.showorgan.split(";"),(function(e,l){return[t._v(" AD "+t._s(e.replace(/\[.*?\]/g,""))),r("br")]}))]:t._e(),t._v(" CL "+t._s(e.class)),r("br"),t._v(" K1 "+t._s(e.keyword_c?e.keyword_c.replace(/\[.*?\]/g,""):"")+" "),r("br"),t._v(" PP 中国"),r("br"),t._v(" DS 重庆维普"),r("br"),t._v(" NO 作者个数:"+t._s(e.showwriter?e.showwriter.split(";").length:0)+"; 第一作者:"+t._s(e.firstwriter)+" "),r("br"),r("br")],2)})),0),r("div",{staticClass:"layui-tab-item",class:{"layui-show":6==t.typeIndex}},t._l(t.articleList,(function(e,l){return r("p",{key:l},[t._v(" %0 Journal Article"),r("br"),t._v(" %A "+t._s(e.showwriter)),r("br"),t._v(" %+: "+t._s(e.showorgan?e.showorgan.replace(/\[.*?\]/g,""):"")),r("br"),t._v(" %T "+t._s(e.title_c)),r("br"),t._v(" %J "+t._s(e.media_c)),r("br"),t._v(" %D "+t._s(e.years)),r("br"),t._v(" %N "+t._s(e.num)),r("br"),t._v(" %V "+t._s(e.vol)),r("br"),t._v(" %K "+t._s(e.keyword_c?e.keyword_c.replace(/\[.*?\]/g,""):"")+" "),r("br"),t._v(" %X "+t._s(e.remark_c)),r("br"),t._v(" %U "+t._s(t.windowPath(e))),r("br"),t._v(" %W 重庆维普资讯有限公司 ")])})),0),r("div",{staticClass:"layui-tab-item",class:{"layui-show":7==t.typeIndex}},[t._v(' <?xml version="1.0" encoding="utf-8"?> '),r("br"),t._v(" <Bibliographies> "),r("br"),t._v(" <BibliographiesCount>"+t._s(t.articleList.length)+"</BibliographiesCount> "),r("br"),t._l(t.articleList,(function(e,l){return[r("br"),t._v(" <Bibliography> "),r("br"),t._v(" <Type>JournalArticle</Type> "),r("br"),t._v(" <Language>zh-CHS</Language> "),r("br"),t._v(' <PrimaryTitle> <Title Lang="zh-CHS"><![CDATA['+t._s(e.title_c)+"]]></Title></PrimaryTitle> "),r("br"),t._v(' <Authors><Author><Info lang="zh-CHS"> '),r("br"),t._v(" <FullName><![CDATA["+t._s(e.showwriter?e.showwriter.replace(/\[.*?\]/g,""):"")+"]]></FullName> "),r("br"),t._v(" <Organization><![CDATA["+t._s(e.showorgan)+"]]></Organization> "),r("br"),t._v(" </Info></Author></Authors> "),r("br"),t._v(' <Medium><Media Lang="zh-CHS"><![CDATA['+t._s(e.media_c)+"]]></Media></Medium> "),r("br"),t._v(" <Year><![CDATA["+t._s(e.years)+"]]></Year> "),r("br"),t._v(" <Volume><![CDATA["+t._s(e.volumn)+"]]></Volume> "),r("br"),t._v(" <Issue><![CDATA["+t._s(e.num)+"]]></Issue> "),r("br"),t._v(" <Keywords> "),r("br"),t._v(' <Keyword Lang="zh-CHS"><![CDATA[['+t._s(e.keyword_c?e.keyword_c.replace(/\[.*?\]/g,""):"")+"]]></Keyword> "),r("br"),t._v(' <Keyword Lang="en"><![CDATA[ '+t._s(e.keyword_e?e.keyword_e.replace(/\[.*?\]/g,""):"")+" ]]></Keyword> "),r("br"),t._v(" </Keywords> "),r("br"),t._v(' <Abstracts><Abstract Lang="zh-CHS"> '),r("br"),t._v(" <![CDATA["+t._s(e.remark_c)+"]]> "),r("br"),t._v(" </Abstract> </Abstracts> "),r("br"),t._v(" <PageScope><![CDATA["+t._s(e.beginpage)+"-"+t._s(e.endpage)+"]]></PageScope> "),r("br"),t._v(" <Publisher><![CDATA["+t._s(e.publisher)+"]]></Publisher> "),r("br"),t._v(" <Code><![CDATA["+t._s(e.class)+"]]></Code> "),r("br"),t._v(" </Bibliography> "),r("br")]})),t._v(" </Bibliographies> "),r("br")],2),r("div",{staticClass:"layui-tab-item",class:{"layui-show":8==t.typeIndex}},[r("div",{staticClass:"export-filter",staticStyle:{"margin-top":"-5em"}},[r("div",{staticClass:"label"},[t._v("已选类型及字段")]),r("ul",[r("el-checkbox-group",{model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},t._l(t.checkBoxes,(function(t,e){return r("li",[r("el-checkbox",{key:e,attrs:{label:t,border:""}})],1)})),0)],1)]),r("div",{staticClass:"submit"},[r("div",{staticClass:"advance-submit"},[r("button",{staticClass:"layui-btn",on:{click:function(e){return t.exportFile()}}},[r("i",{staticClass:"icon-export"}),t._v("导出")])])])]),r("div",{staticClass:"layui-tab-item ",attrs:{id:"outTable"}},[r("el-table",{attrs:{data:t.articleList,border:""}},[r("el-table-column",{attrs:{type:"index",label:"序号"}}),r("el-table-column",{attrs:{prop:"title_c",label:"题名"}}),r("el-table-column",{attrs:{prop:"showwriter",label:"作者"}}),r("el-table-column",{attrs:{prop:"showorgan",label:"机构"}}),r("el-table-column",{attrs:{prop:"imburse",label:"基金"}}),r("el-table-column",{attrs:{prop:"media_c",label:"刊名"}}),r("el-table-column",{attrs:{prop:"years",label:"年"}}),r("el-table-column",{attrs:{prop:"vol",label:"卷"}}),r("el-table-column",{attrs:{prop:"num",label:"期"}}),r("el-table-column",{attrs:{prop:"issn",label:"ISSN号"}}),r("el-table-column",{attrs:{prop:"cn",label:"CN号"}}),r("el-table-column",{attrs:{label:"页码"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.beginpage)+" - "+t._s(e.row.endpage)+" ")]}}])}),r("el-table-column",{attrs:{prop:"keyword_c",label:"关键词"}}),r("el-table-column",{attrs:{prop:"class",label:"分类号"}}),r("el-table-column",{attrs:{prop:"remark_c",label:"文摘"}}),r("el-table-column",{attrs:{label:"网址"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.windowPath(e.row))+" ")]}}])})],1)],1)])])])])])],1)},n=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"row web-intro"},[r("h1",[r("span",{staticClass:"title"},[t._v("导出题录")])])])}],a=(r("4160"),r("c975"),r("ac1f"),r("466d"),r("5319"),r("1276"),r("159b"),r("22ce")),i=r("39f3"),s=r("21a6"),o=r("1146"),c=r.n(o),g={name:"ExportIndex",data:function(){return{ids:[],articleList:[],showType:["文  本","查新格式","参考文献","XML","NoteExpress","Refworks","EndNote","Note First","自定义导出","Excel导出"],checkBoxes:["题名","作者","刊名","机构","文摘","ISSN","CN","页码","关键词","分类号","网址"],typeIndex:0,checked:["题名","作者","刊名","机构","文摘","ISSN","CN","页码","关键词","分类号","网址"]}},methods:{getIdsFromRouter:function(){this.ids=this.$route.query.ids,this.ids.length>0?this.getArticleList():(alert("没有选择需要导出的数据！"),this.$router.go(-1))},formatArticle:function(t){var e=[];return t.forEach((function(t){e.push(t.ndo_content)})),e},getArticleList:function(){var t=this,e=this.ids;Object(a["axiosRequest"])(i["a"]+"search/getArticlesByIds",e,Object(a["axiosOptions"])(null,a["commonContentType"].json)).then((function(e){e.success&&(t.articleList=t.formatArticle(e.pageBean.rows))}))},changeSHowType:function(t){this.typeIndex=t,9==t&&this.exportExcel()},cancelChoose:function(){this.checked=[]},customExport:function(){var t=this.checked;if(t.length<=0)this.$message.error("请选择需要导出的数据！");else{var e=this.buildCuscom(),r=new Blob([e],{type:"text/plain;charset=utf-8"}),l=this.$moment(new Date).format("YYYY-MM-DD")+"@cuscom.txt";Object(s["saveAs"])(r,l)}},buildTxt:function(){for(var t="",e=this.articleList,r=0;r<e.length;r++)t+="["+(r+1)+"] "+(e[r].showwriter?e[r].showwriter.replace(/\[.*?\]/g,"").replace(";",",")+".":"")+e[r].title_c+(e[r].media_c?"."+e[r].media_c+"[J]":"")+","+e[r].years+"("+e[r].num+"):"+(e[r].beginpage?e[r].beginpage+"-":"")+e[r].endpage+(e[r].remark_c?"\r\n"+e[r].remark_c:"")+"\r\n\r\n";return t.replace(/undefined/g,"")},buildChaxin:function(){for(var t="",e=this.articleList,r=0;r<e.length;r++)t+="["+(r+1)+"]"+(e[r].showwriter?e[r].showwriter.replace(/\[.*?\]/g,"").replace(";",",")+".":"")+e[r].title_c+(e[r].media_c?"."+e[r].media_c+"[J]":"")+","+e[r].years+"("+e[r].num+"):"+(e[r].beginpage?e[r].beginpage+"-":"")+e[r].endpage+".\r\n机构：",e[r].showorgan?t+=e[r].showorgan.replace(/\[.*?\]/g,""):t+="",t+="\r\n摘要："+e[r].remark_c+"\r\n\r\n";return t.replace(/undefined/g,"")},buildRef:function(){for(var t="",e=this.articleList,r=0;r<e.length;r++)t+="["+(r+1)+"] "+(e[r].showwriter?e[r].showwriter.replace(/\[.*?\]/g,"").replace(";",",")+".":"")+e[r].title_c+"[J]"+e[r].media_c+","+e[r].years+",("+e[r].num+"):"+e[r].beginpage+"-"+e[r].endpage+"\r\n \r\n";return t.replace(/undefined/g,"")},buildXml:function(){for(var t='&lt;?xml version="1.0" encoding="utf-8"?&gt;\r\n &lt;ResourceList&gt;',e=this.articleList,r=0;r<e.length;r++){t+='\r\n\r\n&lt;PeriodicalPaper xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;\r\n    &lt;Type&gt;'+(r+1)+"&lt;/Type&gt;\r\n    &lt;ID&gt;"+e[r].lngid+"&lt;/ID&gt;\r\n    &lt;Titles&gt;\r\n    &lt;Title&gt;\r\n    &lt;Language&gt;chi&lt;/Language&gt;\r\n    &lt;Text&gt;&lt;![CDATA["+e[r].title_c+"]]&gt;&lt;/Text&gt;\r\n    &lt;/Title&gt;\r\n    &lt;/Titles&gt;\r\n    &lt;Creators&gt;\r\n";var l=e[r].showwriter;if(l)if(-1!=l.indexOf(";")){var n=l.split(";");n.forEach((function(e){t+="    &lt;Creator&gt;\r\n    &lt;Name&gt;&lt;![CDATA["+e+"]]&gt;&lt;/Name&gt;\r\n    &lt;/Creator&gt;\r\n"}))}else t+="    &lt;Creator&gt;\r\n    &lt;Name&gt;&lt;![CDATA["+l+"]]&gt;&lt;/Name&gt;\r\n    &lt;/Creator&gt;\r\n";else t+="    &lt;Creator&gt;\r\n    &lt;Name&gt;&lt;![CDATA[]]&gt;&lt;/Name&gt;\r\n    &lt;/Creator&gt;\r\n";if(t+="    &lt;/Creators&gt;\r\n    &lt;PublishDate&gt;&lt;![CDATA["+e[r].publishdate+"]]&gt;&lt;/PublishDate&gt;\r\n    &lt;CLCs&gt;\r\n",e[r].class)if(-1!=e[r].class.indexOf(";")){var a=e[r].class.split(";");a.forEach((function(e){t+="    &lt;CLC&gt;\r\n    &lt;Code&gt;&lt;![CDATA["+e+"]]&gt;&lt;/Code&gt;\r\n    &lt;/CLC&gt;\r\n"}))}else t+="    &lt;CLC&gt;\r\n    &lt;Code&gt;&lt;![CDATA["+e[r].class+"]]&gt;&lt;/Code&gt;\r\n    &lt;/CLC&gt;\r\n";t+="    &lt;/CLCs&gt;\r\n    &lt;HasOriginalDoc&gt;true&lt;/HasOriginalDoc&gt;\r\n    &lt;DataSource&gt;&lt;/DataSource&gt;\r\n    &lt;Keywords&gt;\r\n";var i=e[r].keyword_c;if(i)if(-1!=i.indexOf(";")){var s=i.split(";");s.forEach((function(e){t+="    &lt;Keyword&gt;&lt;![CDATA["+e.replace(/\[.*?\]/g,"")+"]]&gt;&lt;/Keyword&gt;\r\n"}))}else t+="    &lt;Keyword&gt;&lt;![CDATA["+i.replace(/\[.*?\]/g,"")+"]]&gt;&lt;/Keyword&gt;\r\n";else t+="    &lt;Keyword&gt;&lt;![CDATA[]]&gt;&lt;/Keyword&gt;\r\n";t+="    &lt;/Keywords&gt;\r\n    &lt;Abstracts&gt;\r\n    &lt;Abstract&gt;\r\n    &lt;Text&gt;&lt;![CDATA["+e[r].remark_c+"]]&gt;&lt;/Text&gt;\r\n    &lt;/Abstract&gt;\r\n    &lt;/Abstracts&gt;\r\n    &lt;Periodical&gt;\r\n    &lt;ID&gt;"+e[r].gch+"&lt;/ID&gt;\r\n    &lt;Name&gt;&lt;![CDATA["+e[r].media_c+"]]&gt;&lt;/Name&gt;\r\n    &lt;ISSN&gt;"+e[r].issn+"&lt;/ISSN&gt;\r\n    &lt;/Periodical&gt;\r\n    &lt;Column&gt;&lt;/Column&gt;\r\n",e[r].vol&&(t+="    &lt;Volum&gt;&lt;![CDATA["+e[r].vol+"]]&gt;&lt;/Volum&gt;\r\n"),t+="    &lt;Issue&gt;&lt;![CDATA["+e[r].num+"]]&gt;&lt;/Issue&gt;\r\n    &lt;Page&gt;"+e[r].beginpage+"-"+e[r].endpage+"&lt;/Page&gt;\r\n    &lt;Organs&gt;\r\n";var o=e[r].showorgan;if(o)if(-1!=o.indexOf(";")){var c=o.split(";");c.forEach((function(e){t+="    &lt;Organ&gt;&lt;![CDATA["+e.replace(/\[.*?\]/g,"")+"]]&gt;&lt;/Organ&gt;\r\n"}))}else t+="    &lt;Organ&gt;&lt;![CDATA["+o.replace(/\[.*?\]/g,"")+"]]&gt;&lt;/Organ&gt;\r\n";else t+="    &lt;Organ&gt;&lt;![CDATA[]]&gt;&lt;/Organ&gt;\r\n";t+="    &lt;/Organs&gt;\r\n    &lt;ServiceMode&gt;1&lt;/ServiceMode&gt;\r\n    &lt;/PeriodicalPaper&gt;"}return t+="\r\n    &lt;/ResourceList&gt;",t.replace(/undefined/g,"").replace(/&gt;/g,">").replace(/&lt;/g,"<")},buildNote:function(){for(var t="",e=this.articleList,r=0;r<e.length;r++){t+="{Reference Type}: Journal Article \r\n",t+="{Title}:"+e[r].title_c+"\r\n";var l=e[r].showwriter;if(l)if(-1!=l.indexOf(";")){var n=l.split(";");n.forEach((function(e){t+="{Author}: "+e.replace(/\[.*?\]/g,"")+"\r\n"}))}else t+="{Author}: "+l.replace(/\[.*?\]/g,"")+"\r\n";t+="{Journal}: "+e[r].media_c+"\r\n{Year}: "+e[r].years,e[r].vol&&(t+="\r\n{Volume} : "+e[r].vol),t+="\r\n{Issue}: "+e[r].num+"\r\n";var a=e[r].keyword_c;if(a)if(-1!=a.indexOf(";")){var i=a.split(";");i.forEach((function(e){t+="{Keywords}:"+e.replace(/\[.*?\]/g,"")+"\r\n"}))}else t+="{Keywords}:"+a.replace(/\[.*?\]/g,"")+"\r\n";t+="{Abstract}: "+e[r].remark_c+"\r\n{URL}: "+window.location.href.match(/^(?:[^\/]|\/\/)*/)+"/detail/index?lngid="+e[r].lngid+"\r\n{Database Provider}: 重庆维普资讯有限公司\r\n \r\n \r\n \r\n"}return t.replace(/undefined/g,"")},buildRefworks:function(){for(var t="",e=this.articleList,r=0;r<e.length;r++)t+="RT Journal \r\n",t+="T1 "+e[r].title_c+"\r\nJF "+e[r].media_c+"\r\nYR "+e[r].years+"\r\nVO "+e[r].vol+"\r\nIS "+e[r].num+"\r\nAB "+e[r].remark_c+"\r\nLK "+window.location.href.match(/^(?:[^\/]|\/\/)*/)+"/detail/index?lngid="+e[r].lngid+"\r\nA1 "+(e[r].showwriter?e[r].showwriter.replace(/\[.*?\]/g,""):"")+"\r\nAD "+(e[r].showorgan?e[r].showorgan.replace(/\[.*?\]/g,""):"")+"\r\nCL "+e[r].class+"\r\nK1 "+(e[r].keyword_c?e[r].keyword_c.replace(/\[.*?\]/g,""):"")+"\r\nPP 中国 \r\nDS 重庆维普 \r\nNO 作者个数:"+(e[r].showwriter?e[r].showwriter.split(";").length:0)+"; 第一作者:"+e[r].firstwriter+"\r\n\r\n";return t.replace(/undefined/g,"")},buildEndNote:function(){for(var t="",e=this.articleList,r=0;r<e.length;r++)t+="%0 Journal Article \r\n",t+="%A "+e[r].showwriter+"\r\n%+:"+(e[r].showorgan?e[r].showorgan.replace(/\[.*?\]/g,""):"")+"\r\n%T "+e[r].title_c+"\r\n%J "+e[r].media_c+"\r\n%D "+e[r].years+"\r\n%N "+e[r].num+"\r\n%V "+e[r].vol+"\r\n%K "+(e[r].keyword_c?e[r].keyword_c.replace(/\[.*?\]/g,""):"")+"\r\n%X "+e[r].remark_c+"\r\n%U "+window.location.href.match(/^(?:[^\/]|\/\/)*/)+"/detail/index?lngid="+e[r].lngid+"\r\n%W 重庆维普资讯有限公司 \r\n\r\n";return t.replace(/undefined/g,"")},buildNoteFirst:function(){for(var t=this.articleList,e='&lt;?xml version="1.0" encoding="utf-8"?&gt;\r\n &lt;Bibliographies&gt;\r\n&lt;BibliographiesCount&gt;'+t.length+"&lt;/BibliographiesCount&gt;\r\n",r=0;r<t.length;r++){var l=t[r];e+='&lt;Bibliography&gt;\r\n&lt;Type&gt;JournalArticle&lt;/Type&gt;\r\n&lt;Language&gt;zh-CHS&lt;/Language&gt;\r\n&lt;PrimaryTitle&gt; &lt;Title Lang="zh-CHS"&gt;&lt;![CDATA['+l.title_c+']]&gt;&lt;/Title&gt;&lt;/PrimaryTitle&gt;\r\n&lt;Authors&gt;&lt;Author&gt;&lt;Info lang="zh-CHS"&gt;\r\n&lt;FullName&gt;&lt;![CDATA['+(l.showwriter?l.showwriter.replace(/\[.*?\]/g,""):"")+"]]&gt;&lt;/FullName&gt;\r\n&lt;Organization&gt;&lt;![CDATA[[1]"+(l.showorgan?l.showorgan.replace(/\[.*?\]/g,""):"")+']]&gt;&lt;/Organization&gt;\r\n&lt;/Info&gt;&lt;/Author&gt;&lt;/Authors&gt;\r\n&lt;Medium&gt;&lt;Media Lang="zh-CHS"&gt;&lt;![CDATA['+l.media_c+"]]&gt;&lt;/Media&gt;&lt;/Medium&gt;\r\n&lt;Year&gt;&lt;![CDATA["+l.years+"]]&gt;&lt;/Year&gt;\r\n&lt;Volume&gt;&lt;![CDATA["+l.volumn+"]]&gt;&lt;/Volume&gt;\r\n&lt;Issue&gt;&lt;![CDATA["+l.num+']]&gt;&lt;/Issue&gt;\r\n&lt;Keywords&gt;\r\n&lt;Keyword Lang="zh-CHS"&gt;&lt;![CDATA['+l.keyword_c+']]&gt;&lt;/Keyword&gt;\r\n&lt;Keyword Lang="en"&gt;&lt;![CDATA['+l.keyword_e+']]&gt;&lt;/Keyword&gt;\r\n&lt;/Keywords&gt;\r\n&lt;Abstracts&gt;&lt;Abstract Lang="zh-CHS"&gt;\r\n&lt;![CDATA['+l.remark_c+"]]&gt;\r\n&lt;/Abstract&gt; &lt;/Abstracts&gt;\r\n&lt;PageScope&gt;&lt;![CDATA["+l.beginpage+"-"+l.endpage+"]]&gt;&lt;/PageScope&gt;\r\n&lt;Publisher&gt;&lt;![CDATA["+l.publisher+"]]&gt;&lt;/Publisher&gt;\r\n&lt;Code&gt;&lt;![CDATA["+l.class+"]]&gt;&lt;/Code&gt;\r\n&lt;/Bibliography&gt;\r\n\r\n"}return e+="&lt;/Bibliographies&gt;",e.replace(/undefined/g,"").replace(/&gt;/g,">").replace(/&lt;/g,"<")},buildCuscom:function(){for(var t=this.checked,e="〖检索时间〗"+this.$moment(new Date).format("YYYY-MM-DD HH:mm:ss")+"\r\n 〖检索结果〗选中"+this.ids.length+"篇\r\n",r=this.articleList,l=0;l<r.length;l++)e+="【序  号】"+(l+1)+"/"+r.length+"\r\n",-1!=t.indexOf("题名")&&(e+="【题　名】"+r[l].title_c+"\r\n"),-1!=t.indexOf("作者")&&(e+="【作　者】"+(r[l].showwriter?r[l].showwriter.replace(/\[.*?\]/g,""):"")+"\r\n"),-1!=t.indexOf("机构")&&(e+="【机　构】"+(r[l].showorgan?r[l].showorgan.replace(/\[.*?\]/g,""):"")+"\r\n"),-1!=t.indexOf("刊名")&&(e+="【刊　名】"+r[l].media_c+r[l].years+" "+r[l].vol+"("+r[l].num+"):"+r[l].beginpage+"-"+r[l].endpage+"\r\n"),-1!=t.indexOf("ISSN")&&(e+="【ISSN号】"+r[l].issn+"\r\n"),-1!=t.indexOf("CN")&&(e+="【C N 号】"+r[l].cn+"\r\n"),-1!=t.indexOf("页码")&&(e+="【页　码】"+r[l].beginpage+"-"+r[l].endpage+"\r\n"),-1!=t.indexOf("关键词")&&(e+="【关键词】"+r[l].keyword_c+"\r\n"),-1!=t.indexOf("分类号")&&(e+="【分类号】"+r[l].class+"\r\n"),-1!=t.indexOf("文摘")&&(e+="【文　摘】"+r[l].remark_c+"\r\n"),-1!=t.indexOf("网址")&&(e+="【网　址】"+window.location.href.match(/^(?:[^\/]|\/\/)*/)+"/detail/index?lngid="+r[l].lngid+"\r\n"),e+="\r\n\r\n";return e.replace(/undefined/g,"")},exportExcel:function(){var t=c.a.utils.table_to_book(document.getElementById("outTable")),e=c.a.write(t,{bookType:"xlsx",bookSST:!0,type:"array"}),r=this.$moment(new Date).format("YYYY-MM-DD")+"cqvip.xlsx";Object(s["saveAs"])(new Blob([e],{type:"application/octet-stream"}),r)},exportFile:function(){var t,e=this.typeIndex,r=this.$moment(new Date).format("YYYY-MM-DD");switch(e){case 0:t=this.buildTxt(),r+="@txt.txt";break;case 1:t=this.buildChaxin(),r+="@cx.txt";break;case 2:t=this.buildRef(),r+="@ref.txt";break;case 3:t=this.buildXml(),r+="@xml.xml";break;case 4:t=this.buildNote(),r+="@note.txt";break;case 5:t=this.buildRefworks(),r+="@rew.txt";break;case 6:t=this.buildEndNote(),r+="@end.txt";break;case 7:t=this.buildNoteFirst(),r+="@nf.txt";break;case 8:t=this.buildCuscom(),r+="@cus.txt";default:break}var l=new Blob([t],{type:"text/plain;charset=utf-8"});Object(s["saveAs"])(l,r)},printFile:function(){window.print()},windowPath:function(t){return window.location.href.match(/^(?:[^\/]|\/\/)*/)+"/detail/index?lngid="+t.lngid.replace(/\<.*?\>/g,"")},doCopy:function(){var t,e=this,r=this.typeIndex;switch(r){case 0:t=this.buildTxt();break;case 1:t=this.buildChaxin();break;case 2:t=this.buildRef();break;case 3:t=this.buildXml();break;case 4:t=this.buildNote();break;case 5:t=this.buildRefworks();break;case 6:t=this.buildEndNote();break;case 7:t=this.buildNoteFirst();break;default:break}this.$copyText(t).then((function(t){e.$message.success("内容已成功复制到剪贴板！")})).catch((function(t){e.$message.error("复制内容出错！")}))}},created:function(){this.getIdsFromRouter()}},u=g,_=(r("905d"),r("2877")),d=Object(_["a"])(u,l,n,!1,null,"a9f5fe7a",null);e["default"]=d.exports},3:function(t,e){},4:function(t,e){},5:function(t,e){},"905d":function(t,e,r){"use strict";var l=r("c826"),n=r.n(l);n.a},c826:function(t,e,r){}}]);