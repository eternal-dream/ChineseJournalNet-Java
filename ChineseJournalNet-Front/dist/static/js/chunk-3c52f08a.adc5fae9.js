(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c52f08a","chunk-2d0a3b14"],{"02ea":function(e,t,s){"use strict";s.r(t);var l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:e.title,visible:e.visible,width:"30%","before-close":e.close,"close-on-click-modal":!1,inline:!0},on:{"update:visible":function(t){e.visible=t}}},[s("el-form",{ref:"roleForm",attrs:{model:e.role}},[s("el-form-item",{attrs:{label:"角色名称",prop:"name","label-width":"100px",rules:{required:!0,message:"请输入角色名称!",trigger:"blur"}}},[s("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.role.name,callback:function(t){e.$set(e.role,"name",t)},expression:"role.name"}})],1),s("el-form-item",{attrs:{label:"描述",prop:"description","label-width":"100px"}},[s("el-input",{attrs:{type:"textarea",placeholder:"请描述角色用途"},model:{value:e.role.description,callback:function(t){e.$set(e.role,"description",t)},expression:"role.description"}})],1),s("el-form-item",{attrs:{label:"权限设置","label-width":"100px"}},[s("el-tree",{ref:"tree",attrs:{data:e.resources,"show-checkbox":"","node-key":"id","highlight-current":!0,props:{children:"children",label:"title"}},on:{"check-change":e.getChooseData},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.node,o=t.data;return s("span",{staticClass:"custom-tree-node"},[s("span",[e._v(" "+e._s(l.label)+" "),"C"===o.menuType?s("el-tag",{attrs:{size:"mini"}},[e._v("菜单")]):e._e(),"M"===o.menuType?s("el-tag",{attrs:{size:"mini",type:"info"}},[e._v("目录")]):e._e(),"F"===o.menuType?s("el-tag",{attrs:{size:"mini",type:"warning"}},[e._v("按钮")]):e._e()],1)])}}])})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.close}},[e._v("取 消")]),s("el-button",{attrs:{"el-button":"",type:"primary"},on:{click:e.submit}},[e._v("确定")])],1)],1)],1)},o=[],a=(s("4160"),s("159b"),{props:["searchRole"],data:function(){return{visible:!1,role:{resourceIds:[]},title:"",resources:[]}},created:function(){this.getResources()},methods:{show:function(e){var t=this;this.role=JSON.parse(JSON.stringify(e)),e&&e.id?(this.title="编辑角色",e.resourceIds&&e.resourceIds.length>0&&e.resourceIds.forEach((function(e){t.$nextTick((function(){t.$refs.tree.setChecked(e,!0,!1)}))}))):this.title="新增角色",this.visible=!0},close:function(){this.$refs.roleForm.resetFields(),this.$refs.tree.setCheckedKeys([]),this.visible=!1},getResources:function(){var e=this;this.$axiosRequest("/system/resource/getAllResources",{},this.$axiosOptions("get")).then((function(t){e.resources=t.resources}))},getChooseData:function(){var e=this.$refs.tree,t=e.getCheckedNodes(!1,!0),s=[];t.forEach((function(e){s.push(e.id)})),this.role.resourceIds=s},submit:function(){var e=this;this.$refs.roleForm.validate((function(t){t&&e.$axiosRequest("/system/role/addOrModifyRole",JSON.stringify(e.role),e.$axiosOptions("post","application/json")).then((function(t){t.success?(e.$message.success("操作成功!"),e.visible=!1,e.close(),e.searchRole()):e.$message.error(t.msg)}))}))}}}),r=a,n=s("2877"),i=Object(n["a"])(r,l,o,!1,null,null,null);t["default"]=i.exports},"1b9e":function(e,t,s){"use strict";s.r(t);var l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("d2-container",{attrs:{type:"full"}},[s("template",{slot:"header"},[s("h4",[e._v("角色搜索")]),s("el-form",{ref:"form",attrs:{model:e.queryParams,inline:!0}},[s("el-col",{attrs:{span:7}},[s("el-form-item",{attrs:{label:"角色名称",prop:"name","label-width":"100px"}},[s("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.queryParams.name,callback:function(t){e.$set(e.queryParams,"name",t)},expression:"queryParams.name"}})],1)],1),s("el-col",[s("el-button",{attrs:{type:"success",size:"small"},on:{click:function(t){return e.handleEdit({})}}},[s("d2-icon",{attrs:{name:"plus"}}),e._v("添加")],1),s("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.handleQuery}},[e._v("搜索")])],1)],1)],1),s("template",{slot:"default"},[s("el-table",{attrs:{data:e.roleList,size:"mini","empty-text":"未查询到角色信息",stripe:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55",align:"center",fixed:""}}),s("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),s("el-table-column",{attrs:{prop:"name",label:"角色名","show-overflow-tooltip":!0,align:"center"}}),s("el-table-column",{attrs:{prop:"description",label:"描述","show-overflow-tooltip":!0,align:"center"}}),s("el-table-column",{attrs:{label:"操作",width:"310px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{staticStyle:{padding:"5px"},attrs:{type:"warning",icon:"el-icon-edit",size:"small"},on:{click:function(s){return e.handleEdit(t.row)}}},[e._v("编辑")]),s("el-button",{staticClass:"red",staticStyle:{padding:"5px"},attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(s){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.queryParams.pageNum,"page-size":e.queryParams.pageSize,total:e.total},on:{"current-change":e.handlePageChange}})],1)],1),s("role-form",{ref:"roleForm",attrs:{searchRole:e.searchRole}})],2)},o=[],a=s("cd49"),r=s("bc3a"),n=s.n(r),i=s("02ea"),c={name:"Role",components:{roleForm:i["default"]},data:function(){return{queryParams:{pageNum:1,pageSize:10},param:a["commonEnums"],multipleSelection:[],ids:[],roleList:[],total:0,roles:[]}},created:function(){this.getRoles(),this.searchRole()},methods:{searchRole:function(){var e=this;this.$axiosRequest("/system/role/getRoles",this.queryParams,{method:"get"}).then((function(t){e.roleList=t.roles,e.total=t.total}))},handleQuery:function(){this.queryParams.pageNum=1,this.searchRole()},handleEdit:function(e){this.$refs.roleForm.show(e)},handlePageChange:function(e){this.queryParams.pageNum=e,this.searchRole()},handleSelectionChange:function(e){this.multipleSelection=e},getRoles:function(){var e=this;this.$axiosRequest("system/role/getTotalRoles",{},this.$axiosOptions("get")).then((function(t){e.roles=t.totalRoles}))},handleDelete:function(e){this.ids=[e.id],this.deleteRole()},deleteRole:function(){var e=this;0!==this.ids.length?this.$confirm("确定删除选中的角色吗？删除后可能导致某些功能无法使用","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n()({method:"post",url:"/system/role/deleteRole",data:e.ids}).then((function(t){t.data.success?(e.$message.success("删除成功!"),e.searchRole()):e.$message.error(t.data.msg)}))})):this.$message.error("请选择要删除的角色!")}}},u=c,h=s("2877"),d=Object(h["a"])(u,l,o,!1,null,null,null);t["default"]=d.exports}}]);